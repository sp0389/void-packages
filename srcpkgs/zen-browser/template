# Template file for 'zen-browser'
pkgname=zen-browser
version=1.16.1b
revision=1
only_for_archs="x86_64"
wrksrc="${pkgname}-${version}"
hostmakedepends="tar"
depends="libX11 libXcomposite libXdamage libXext libXfixes libXt libXtst \
libxkbcommon libxkbcommon-x11 libpng glib gtk+3"
short_desc="Web Browser"
maintainer="Graeme Bevins <seventh.theory@protonmail.com>"
license="MPL-2.0"
homepage="https://www.zen-browser.app/"
distfiles="https://github.com/zen-browser/desktop/releases/download/${version/a/-a}/zen.linux-x86_64.tar.xz"
checksum=7964e7a1cb25457ba4617a42608b4a8f73a2dccd92d31da298de02fb3468d66e

do_install() {
	# Install program files
	vmkdir usr/lib/zen-browser
	vcopy * usr/lib/zen-browser

	# Symlink binary into /usr/bin
	vmkdir usr/bin
	ln -s ../lib/zen-browser/zen ${DESTDIR}/usr/bin/zen-browser

	# Install desktop entry
	vmkdir usr/share/applications
	cat > ${DESTDIR}/usr/share/applications/zen-browser.desktop <<EOF

[Desktop Entry]
Name=Zen
Comment=Web Browser
Exec=zen-browser
Terminal=false
Type=Application
Icon=zen-browser
Categories=Network;WebBrowser;
MimeType=text/html;text/xml;application/xhtml+xml;x-scheme-handler/http;x-scheme-handler/https;
StartupNotify=true
EOF

	# Install icons
	for size in 16 32 48 64 128; do
		if [ -f browser/chrome/icons/default/default${size}.png ]; then
			vmkdir usr/share/icons/hicolor/${size}x${size}/apps
			vcopy browser/chrome/icons/default/default${size}.png \
				usr/share/icons/hicolor/${size}x${size}/apps/zen-browser.png
		fi
	done
}
